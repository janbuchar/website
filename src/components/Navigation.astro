---
import { getAbsoluteLocaleUrl } from "astro:i18n";
import { css, cva } from "@styled-system";
import Link from "@components/Link.astro";

const navLink = cva({
  base: {
    paddingX: "large-half",
    paddingY: "none",
    whiteSpace: "nowrap",
    height: "var(--navbar-height)",
    color: "polarNight4",
    "&:hover": {
      color: "polarNight1",
    },
  },
  variants: {
    activity: {
      inactive: {
        background: "none",
      },
      active: {
        background: "snowStorm1",
      },
    },
    style: {
      base: {
        lineHeight: "[calc(var(--navbar-height) + 2px)]", // Nudge regular links to "brand" level
      },
      brand: {
        fontSize: "brand",
        fontWeight: "bolder",
        lineHeight: "var(--navbar-height)",
      },
    },
  },
  compoundVariants: [
    {
      style: "brand",
      activity: "active",
      css: {
        background: "none",
      },
    },
  ],
  defaultVariants: { activity: "inactive", style: "base" },
});

const path = Astro.url.pathname.replace(/^\/cs/, "");
---

<header
  class={css({
    background: "snowStorm3",
    marginBottom: "bigger",
    display: "flex",
    flexDirection: { base: "column", sm: "row" },
    alignItems: { base: "stretch", sm: "unset" },
    justifyContent: { base: "unset", sm: "space-between" },
    "& nav": {
      display: "flex",
      alignItems: "flex-start",
      paddingX: "large-half",
    },
  })}
>
  <nav>
    <Link
      href={getAbsoluteLocaleUrl(Astro.currentLocale!, "/")}
      class={(isActive) =>
        navLink({ style: "brand", activity: isActive ? "active" : "inactive" })}
    >
      Jan Buchar
    </Link>
    <Link
      href={getAbsoluteLocaleUrl(Astro.currentLocale!, "/blog")}
      matcher={/\/blog\/.*/}
      class={(isActive) =>
        navLink({ activity: isActive ? "active" : "inactive" })}
    >
      Blog
    </Link>
  </nav>
  <nav>
    <a href={getAbsoluteLocaleUrl("en", path)} class={navLink()}> English </a>
    <a href={getAbsoluteLocaleUrl("cs", path)} class={navLink()}> ÄŒesky </a>
    <Link
      href={getAbsoluteLocaleUrl(Astro.currentLocale!, "/blog/archives")}
      class={(isActive) =>
        navLink({ activity: isActive ? "active" : "inactive" })}
    >
      Archives
    </Link>
  </nav>
</header>
